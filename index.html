<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Function Match — p5.js</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.9.3/lib/p5.min.js"></script>

  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>

  <style>
    html,body{margin:0;background:#000;color:#ddd;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    #legend{position:fixed;top:12px;left:12px;background:#0a0a0a80;padding:10px 12px;border-radius:10px;border:1px solid #333;max-width:min(88vw,760px);font-size:12px;z-index:4}
    #legend b{color:#9ff}
    #legend .katex{font-size:.95rem}
    #status{position:fixed;top:12px;right:12px;background:#0a0a0a80;padding:10px 12px;border-radius:10px;border:1px solid #333;min-width:260px;z-index:3}
    #accuracy{margin-bottom:6px}
    #formulaBox .katex{font-size:1.05rem}
    #targetFormula{opacity:.9;margin-top:6px;display:none}
    #ui{position:fixed;bottom:16px;left:50%;transform:translateX(-50%);display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:center;z-index:2}
    .pad{padding:8px 12px;border:1px solid #444;background:#111;color:#ddd;border-radius:8px;cursor:pointer;user-select:none;min-width:44px;text-align:center}
    .pad:active{background:#1a1a1a}
    .pad.toggle.on,.pad.state.on{outline:2px solid #6cf;box-shadow:0 0 12px #0cf8}
    .small{font-size:12px;opacity:.85}
    label{cursor:pointer}
    canvas{display:block}

    /* ===== Mobile layout ===== */
    #helpToggle{display:none} /* shown only on mobile */
    @media (max-width: 700px){
      #helpToggle{display:block;position:fixed;top:12px;left:12px;z-index:5;background:#0a0a0a80}
      /* legend hidden by default; shown only when checkbox checked */
      #legend{display:none}
      #toggleLegend:checked ~ #legend{display:block}

      canvas{margin-top:-45px}

      #status{top:8px;right:8px}
      #ui{
        left:0; right:0; bottom:8px; transform:none;
        display:grid; padding:8px;
        grid-template-columns: repeat(4, minmax(56px,1fr));
        grid-auto-rows:44px; gap:8px;
      }
      .pad{min-width:auto;padding:10px 12px}
      .wide{grid-column:span 2}
    }
  </style>
</head>
<body>

<!-- Mobile help toggle (must come before #legend for CSS to work) -->
<input type="checkbox" id="toggleLegend" hidden>
<label for="toggleLegend" id="helpToggle" class="pad small">Help</label>

<div id="legend">
  <div><b>Base</b>: [1] Linear, [2] Quadratic, [3] Exp, [4] Log</div>
  <div><b>Form</b>: y = a·f(b(x − h)) + d</div>
  <div><b>Move</b>: ←/→ change <b>h</b> (inside) • ↑/↓ change <b>d</b> (outside, after ALL wrappers)</div>
  <div><b>Scale</b>: <b>Shift</b>+←/→ change <b>b</b> • <b>Shift</b>+↑/↓ change <b>a</b> (sign allowed)</div>
  <div><b>Mods</b>: [A] absolute (wrap current) • [N] negate y (wrap current) • [M] mirror x (x→−x). A/N press again = undo to exact pre-toggle state.</div>
  <div class="small"><label><input type="checkbox" id="chkShowTargetFormula"> Show target formula</label></div>
</div>

<div id="status">
  <div id="accuracy">Acc: 0.00%</div>
  <div id="formulaBox">
    <div id="playerFormula"></div>
    <div id="targetFormula"></div>
  </div>
</div>

<!-- add class "wide" to Shift and Space so they span 2 columns on mobile -->
<div id="ui">
  <div id="btnShift" class="pad toggle wide">Shift</div>
  <div id="btnA" class="pad state">A</div>
  <div id="btnN" class="pad state">N</div>
  <div id="btnM" class="pad state">M</div>
  <div id="btnR" class="pad">R</div>
  <div id="btnSpace" class="pad wide">Space</div>
  <div id="btn1" class="pad">1 lin</div>
  <div id="btn2" class="pad">2 quad</div>
  <div id="btn3" class="pad">3 exp</div>
  <div id="btn4" class="pad">4 log</div>
  <div id="btnLeft" class="pad">←</div>
  <div id="btnRight" class="pad">→</div>
  <div id="btnUp" class="pad">↑</div>
  <div id="btnDown" class="pad">↓</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/p5@1.4.2/lib/p5.min.js"></script>
<script src="elementarysketch.js"></script>
</body>
</html>
